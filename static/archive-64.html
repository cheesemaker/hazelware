<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<head>
	<title>Hazelware</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body vlink='#3173EB' link='#3173EB' leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>
<meta name="ICBM" content="45.30027, -122.9719" />
<meta name="keywords" content="Palm PalmOS WinCE PocketPC PDA Development Wireless" />
<meta name="description" content="Postings from a wireless PDA developer." />
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />
<table border=0 valign=top width=830>
	<TR>
		<TD width=150>
			&nbsp
		</TD>
		<TD width=620>
			<center><IMG SRC="/images/title.jpg" border=0 width=319 height=69></center>
			<br>&nbsp &nbsp &nbsp 

				<b><small>Logged in as <I><A HREF='/login.html'>Guest</A></I> &nbsp Sun, Oct. 21st, 7:26 AM.  &nbsp &nbsp &nbsp </small></b>
		</TD>
		<TD width=60>
			&nbsp
		</TD>
	</TR>
	<TR>
		<TD width=150>

		<TABLE border = 1 cellspacing=0 cellpadding=0><TR><TD>

<!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="_top">
<table border="0" bgcolor="#ffffff">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">

</td>
<td nowrap="nowrap">
<input type="hidden" name="domains" value="hazelware.luggle.com"></input>
<input type="text" name="q" size="16" maxlength="255" value=""></input>
</td></tr>
<tr>
<td>&nbsp;</td>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked="checked"></input>
<font size="-1" color="#000000">Web</font>
</td>
<td>
<input type="radio" name="sitesearch" value="hazelware.luggle.com"></input>
<font size="-1" color="#000000">hazelware.luggle.com</font>
</td>
</tr>
</table>
<input type="submit" name="sa" value="Google Search"></input>
<input type="hidden" name="client" value="pub-1164091726055367"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1;"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google -->

		</TD></TR></TABLE>


		</TD>
		<TD width=620>
			<TABLE width="100%" align=center>
				<TR>
					<TD width="100%">
						<MAP NAME="linkmap">
							<AREA SHAPE="RECT" COORDS= "10,27,90,52"  HREF="/">
							<AREA SHAPE="RECT" COORDS="100,27,207,52" HREF="/programs/">
							<AREA SHAPE="RECT" COORDS="220,27,328,52" HREF="/tutorials/">
							<AREA SHAPE="RECT" COORDS="338,27,428,52" HREF="/friends/">
							<AREA SHAPE="RECT" COORDS="442,27,509,52" HREF="/links/">
							<AREA SHAPE="RECT" COORDS="517,27,608,52" HREF="mailto:bosshogg@luggle.com">
						</MAP>
						<IMG src="/images/header.jpg" width=619 height=79 USEMAP="#linkmap" border=0>
					</TD>
				</TR>
			</TABLE>

		</TD>
		<TD>
			&nbsp
		</TD>
		<TD>

<script type="text/javascript"><!--
google_ad_client = "pub-1164091726055367";
google_ad_width = 180;
google_ad_height = 60;
google_ad_format = "180x60_as_rimg";
google_cpa_choice = "CAAQqMWkgwIaCAUyS9YT-yjmKMzD4IEBMAA";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

		</TD>	
	</TR>
	
	<TR>
		<TD align=right valign=top>

<script type="text/javascript"><!--
google_ad_client = "pub-1164091726055367";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text";
google_ad_channel ="";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

		</TD>
		<TD width=620 valign=top>


<style type="text/css">
<!--
A		{text-decoration:none}
a		{text-decoration:none}
A:hover 	{ color: #000000;  }
a:hover 	{ color: #000000;  }
-->
</style>

<TABLE border=0 cellspacing=0 cellpadding=5 width=580 align=center valign=top bordercolor='#ffffff'>
	<TR>
		<TD bgcolor='#ffffff'>
			<HR><CENTER><BIG><BIG><B><a href='/archive-64.html' border=0>Checking For the Patched NVFS Implementation</a></B></BIG></BIG></CENTER>
		</TD>
	</TR>
	<TR>
		<TD bgcolor='#ffffff'>
			<FONT COLOR=#000000>
			 The standard way to query the OS version on the PalmOS is to use a snippet of code that looks something like this:
<PRE>
UInt32 romVersion = 0;
FtrGet(sysFtrCreator,sysFtrNumROMVersion, &romVersion);
</PRE>
After calling this, your romVersion variable will be filled with the version of the OS that is running in the format of 0xMMmfsbbb.  Expanding on this, the MM is the major version, the m is the minor version and the f is the "fix" version.  Here&#39;s an example: if the version of the PalmOS that your PDA was running was 4.1.2, the value returned from this function would be something like 0x04120000.  (The 0&#39;s might be something else, but for all intents and purposes, the only ones you care about are the MM, the m and the f.)  <BR>If you are looking for a feature that is specific to a particular OS, it is more advisable to check for that feature inidividually, rather than check the OS version.  However, there certainly are examples where the only way to check for a feature is by checking the OS version.  One current example of this has presented itself with the advent of NVFS.  I won&#39;t go into the details of NVFS in this article, however, suffice it to say that the original implementation of NFVS was lacking.  In response to this perceived deficiency, palmOne has released a newer version that is available as a ROM update to Sprint Treo 650s and comes by default in the new Tungsten E2.  
<BR>According to the documentation, the way to check for the presence of NVFS is to use something like this:
<PRE>
FtrGet(sysFtrCreator, sysFtrNumDmAutoBackup, &returnVal);
</PRE>
<BR>If returnVal is 1, then the device uses NVFS.  Now, with two different NVFS implementations, we are presented with the problem of knowing <I>which</I> version of NVFS we have.  There are many projects (including my own) that have implemented "special" workarounds for NVFS.  With the newer implementation, developers may not want to use those workarounds if the updated version of NVFS is present.
<BR>Here is where we come to the real meat of the article.  As I was digging around looking at the two different Sprint Treo 650s that I have, I noticed that the unpatched device is running PalmOS version 5.4.5 and the patched device is running 5.4.7.  I then checked my E2 which comes with the updated NVFS implementation and it also is running 5.4.7.  So, armed with this knowledge, I have been able to deduce that the way to check whether a device has the updated NVFS implementation is to check that the OS version is greater than or equal to 5.4.7.  Easy enough right?  Well, as usual there&#39;s a wrinkle.  On the Tungsten T5, the Treo 650 and the Tungsten E2, the code that I presented at the beginning of the article doesn&#39;t quite work.  These devices all return 0x05400000.  That seemed very strange because the finder displays the correct version.  So, I went digging to see if there are other ways to query for the OS version.  This led me to the SysGetROMTokenString function.  To be honest, I had never used this function before because it returns a string value instead of a numeric value.  However, as it turns out, this function returns the correct information on the new devices.  
<BR>I could probably write more about this, but the moral of this story is that the only way to check for the updated NVFS implementation is to call SysGetROMTokenString() and parse the returned string to check  for OS version 5.4.7 or greater.  
<BR>As always, I hope this helps you in your journeys, and if you find it helpful, <A HREF="mailto:bosshogg@luggle.com">I always like to know</A>.
<BR>
<BR>-Jon 
			</FONT>
		</TD>
	</TR>
	<TR>
		<TD bgcolor='#dddddd' align = center colspan=2>
		<i>Submitted by bosshogg on Wednesday the 31st 1970f December 1969, at 04:00</i>
		</TD>
	</TR>
</TABLE>
<BR>
</TD>
<TD width=20>
&nbsp
</TD>
<TD valign=top align=right>
<TABLE border=0 cellspacing=0 cellpadding=0 width=150 align=center valign=top bordercolor='#000000'>
<TR><TD>
<TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Recent Entries:</B></TD></TR>
<TR><TD bgcolor='#ffffff' height=100%>
<small>
<TABLE valign=top align=left>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-98.html'><small>I&#39;m BACK!!!!!!</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-97.html'><small>Code Monkey</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-96.html'><small>Cool 3D Code Snippet From My Former Life</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-95.html'><small>YouTube: The Revival of the Internet Time Killer</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-94.html'><small>WhereMate Released</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-93.html'><small>Palmasaurus Released As Freeware</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-92.html'><small>VM-Plus Beta</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-91.html'><small>Handspring Undocumented APIs</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-90.html'><small>Posting Malaise</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-89.html'><small>PhoneShield Released!!!</small></a></TD></TR>
</TABLE>
</TD></TR>
<TR><TD align=center valign=center>
<A HREF='/rss.xml'><IMG SRC='/images/rss.gif' border=0 width=60 height=14></A>
</TD></TR>
</TABLE>
</TD></TR>
<TR><TD><SMALL><SMALL><BR></SMALL></SMALL></TD></TR><TR><TD><TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Archive:</B></TD></TR><TR><TD bgcolor='#ffffff'><A HREF='/archive-2007.10.html'>October - 2007</A><br><A HREF='/archive-2007.8.html'>August - 2007</A><br><A HREF='/archive-2007.7.html'>July - 2007</A><br><A HREF='/archive-2007.6.html'>June - 2007</A><br><A HREF='/archive-2007.5.html'>May - 2007</A><br><A HREF='/archive-2007.4.html'>April - 2007</A><br><A HREF='/archive-2006.12.html'>December - 2006</A><br><A HREF='/archive-2006.11.html'>November - 2006</A><br><A HREF='/archive-2006.9.html'>September - 2006</A><br><A HREF='/archive-2006.8.html'>August - 2006</A><br><A HREF='/archive-2006.7.html'>July - 2006</A><br><A HREF='/archive-2006.3.html'>March - 2006</A><br><A HREF='/archive-2006.2.html'>February - 2006</A><br><A HREF='/archive-2006.1.html'>January - 2006</A><br><A HREF='/archive-2005.12.html'>December - 2005</A><br><A HREF='/archive-2005.11.html'>November - 2005</A><br><A HREF='/archive-2005.10.html'>October - 2005</A><br><A HREF='/archive-2005.9.html'>September - 2005</A><br><A HREF='/archive-2005.8.html'>August - 2005</A><br><A HREF='/archive-2005.7.html'>July - 2005</A><br><A HREF='/archive-2005.6.html'>June - 2005</A><br><A HREF='/archive-2005.5.html'>May - 2005</A><br><A HREF='/archive-2005.4.html'>April - 2005</A><br><A HREF='/archive-2005.2.html'>February - 2005</A><br><A HREF='/archive-2005.1.html'>January - 2005</A><br><A HREF='/archive-2004.12.html'>December - 2004</A><br><A HREF='/archive-2004.11.html'>November - 2004</A><br><A HREF='/archive-2004.10.html'>October - 2004</A><br><A HREF='/archive-2004.9.html'>September - 2004</A><br><A HREF='/archive-2004.8.html'>August - 2004</A><br><A HREF='/archive-2004.7.html'>July - 2004</A><br><A HREF='/archive-2004.6.html'>June - 2004</A><br><A HREF='/archive-2004.5.html'>May - 2004</A><br><A HREF='/archive-2004.4.html'>April - 2004</A><br><A HREF='/archive-2004.3.html'>March - 2004</A><br></TD></TR></TABLE></small>
</TD></TR></TABLE>
		</TD>
	</TR>
</TABLE>
<BR>
<TABLE width=800>
	<TR>
		<TD width=120>
			&nbsp
		</TD>
		<TD>
			<MAP NAME="siteinfo">
				<AREA SHAPE="RECT" COORDS="525,6,545,23" HREF="http://www.redhat.com/">
				<AREA SHAPE="RECT" COORDS="546,6,575,23" HREF="http://www.apache.org/">
				<AREA SHAPE="RECT" COORDS="576,6,607,23" HREF="http://www.php.net/">
			</MAP>
			<IMG SRC="/images/footer.jpg" USEMAP="#siteinfo" border=0 width=619 height=26>
		</TD>
	</TR>
</TABLE>
</body>
</html>



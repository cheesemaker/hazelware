<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<head>
	<title>Hazelware</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<LINK REL="SHORTCUT ICON" HREF="logo.ico">
</head>



<body vlink='#3173EB' link='#3173EB' leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>

<meta name="ICBM" content="45.30027, -122.9719" />
<meta name="keywords" content="Palm PalmOS WinCE PocketPC PDA Development Wireless" />
<meta name="description" content="Postings from a wireless PDA developer." />
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />
<style type="text/css">
<!--
A		{text-decoration:none}
a		{text-decoration:none}
A:hover 	{ color: #000000;  }
a:hover 	{ color: #000000;  }
-->
</style>


<table border=0 valign=top width=780>
	<TR>
		<TD width=100 valign=top>
		</TD>

		<!-- Title graphic -->
		<TD width=620 valign=top>
			<center><IMG SRC="/images/title.jpg" border=0 width=319 height=69></center>
			<br>&nbsp &nbsp &nbsp 


				<b><small>Logged in as <I><A HREF='/login.html'>Guest</A></I> &nbsp Fri, Mar. 26th, 4:19 AM.  &nbsp &nbsp &nbsp </small></b>
	
		</TD>
		<TD>
		</TD>
	</TR>
	<TR>

		<!-- Spacer for left border -->
		<TD>
		<!-- MyMap -->
		<a href="http://www.maploco.com/view.php?id=2376202"><img border=0 width=150 height=75 src="http://www.maploco.com/vmap/2376202.png" alt="Visitor Map"></a>
		</TD>

		<!-- Image map for browsing -->
		<TD width=620 valign=top>
			<TABLE width="100%" align=center valign=top>
				<TR>
					<TD width="100%">
						<MAP NAME="linkmap">
							<AREA SHAPE="RECT" COORDS= "10,27,90,52"  HREF="/">
							<AREA SHAPE="RECT" COORDS="100,27,207,52" HREF="/programs/">
							<AREA SHAPE="RECT" COORDS="220,27,328,52" HREF="/tutorials/">
							<AREA SHAPE="RECT" COORDS="338,27,428,52" HREF="/friends/">
							<AREA SHAPE="RECT" COORDS="442,27,509,52" HREF="/links/">
							<AREA SHAPE="RECT" COORDS="517,27,608,52" HREF="mailto:bosshogg@luggle.com">
						</MAP>
						<IMG src="/images/header.jpg" width=619 height=79 USEMAP="#linkmap" border=0>
					</TD>
				</TR>
			</TABLE>

		</TD>

		<TD>
		</TD>

		<TD>
		</TD>	
	</TR>
	
	<TR>
		<TD align=right valign=top>

		<TABLE border=0 cellspacing=0 cellpadding=0 width=150 align=center valign=top bordercolor='#000000'>
<TR><TD>
<TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Recent Entries:</B></TD></TR>
<TR><TD bgcolor='#ffffff' height=100%>
<small>
<TABLE valign=top align=left>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-127.html'><small>My Dev Setup Lately</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-126.html'><small>Three Ways To Randomize on the iPhone</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-125.html'><small>How to Remove .svn Directories On a Mac</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-124.html'><small>How To Detect The iPhone Simulator</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-123.html'><small>iPhoneMom Likes Doodle Games!</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-122.html'><small>Updates To the Doodle Games Line</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-120.html'><small>Three Jacks Now Tweets</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-119.html'><small>Second iPhone App Submitted For Approval!</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-118.html'><small>Pinch Media Analytics for iPhone</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-117.html'><small>New iPhone Game Coming Soon!</small></a></TD></TR>
</TABLE>
</TD></TR>
<TR><TD align=center valign=center>
<A HREF='/rss.xml'><IMG SRC='/images/rss.gif' border=0 width=60 height=14></A>
</TD></TR>
</TABLE>
</TD></TR>
<TR><TD><SMALL><SMALL><BR></SMALL></SMALL></TD></TR><TR><TD><TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Archive:</B></TD></TR><TR><TD bgcolor='#ffffff'><A HREF='/archive-2010.1.html'>January - 2010</A><br><A HREF='/archive-2009.11.html'>November - 2009</A><br><A HREF='/archive-2009.10.html'>October - 2009</A><br><A HREF='/archive-2009.9.html'>September - 2009</A><br><A HREF='/archive-2009.8.html'>August - 2009</A><br><A HREF='/archive-2009.7.html'>July - 2009</A><br><A HREF='/archive-2009.6.html'>June - 2009</A><br><A HREF='/archive-2009.4.html'>April - 2009</A><br><A HREF='/archive-2009.3.html'>March - 2009</A><br><A HREF='/archive-2009.1.html'>January - 2009</A><br><A HREF='/archive-2008.5.html'>May - 2008</A><br><A HREF='/archive-2008.4.html'>April - 2008</A><br><A HREF='/archive-2008.3.html'>March - 2008</A><br><A HREF='/archive-2007.10.html'>October - 2007</A><br><A HREF='/archive-2007.8.html'>August - 2007</A><br><A HREF='/archive-2007.7.html'>July - 2007</A><br><A HREF='/archive-2007.6.html'>June - 2007</A><br><A HREF='/archive-2007.5.html'>May - 2007</A><br><A HREF='/archive-2007.4.html'>April - 2007</A><br><A HREF='/archive-2006.12.html'>December - 2006</A><br><A HREF='/archive-2006.11.html'>November - 2006</A><br><A HREF='/archive-2006.9.html'>September - 2006</A><br><A HREF='/archive-2006.8.html'>August - 2006</A><br><A HREF='/archive-2006.7.html'>July - 2006</A><br><A HREF='/archive-2006.3.html'>March - 2006</A><br><A HREF='/archive-2006.2.html'>February - 2006</A><br><A HREF='/archive-2006.1.html'>January - 2006</A><br><A HREF='/archive-2005.12.html'>December - 2005</A><br><A HREF='/archive-2005.11.html'>November - 2005</A><br><A HREF='/archive-2005.10.html'>October - 2005</A><br><A HREF='/archive-2005.9.html'>September - 2005</A><br><A HREF='/archive-2005.8.html'>August - 2005</A><br><A HREF='/archive-2005.7.html'>July - 2005</A><br><A HREF='/archive-2005.6.html'>June - 2005</A><br><A HREF='/archive-2005.5.html'>May - 2005</A><br><A HREF='/archive-2005.4.html'>April - 2005</A><br><A HREF='/archive-2005.2.html'>February - 2005</A><br><A HREF='/archive-2005.1.html'>January - 2005</A><br><A HREF='/archive-2004.12.html'>December - 2004</A><br><A HREF='/archive-2004.11.html'>November - 2004</A><br><A HREF='/archive-2004.10.html'>October - 2004</A><br><A HREF='/archive-2004.9.html'>September - 2004</A><br><A HREF='/archive-2004.8.html'>August - 2004</A><br><A HREF='/archive-2004.7.html'>July - 2004</A><br><A HREF='/archive-2004.6.html'>June - 2004</A><br><A HREF='/archive-2004.5.html'>May - 2004</A><br><A HREF='/archive-2004.4.html'>April - 2004</A><br><A HREF='/archive-2004.3.html'>March - 2004</A><br></TD></TR></TABLE></small>
</TD></TR></TABLE>

		</TD>
		<TD width=620 valign=top>


<TABLE border=1 bordercolor='#000000' cellspacing=0 cellpadding=0>
<TR><TD>
<TABLE width=600 BGCOLOR='#B5D0FF' height=50><TR><TD>
<CENTER>
<BIG><BIG><B>
MCI CD Control
</B></BIG></BIG>
</CENTER>
</TD></TR></TABLE>
</TD></TR><TR><TD>

<TABLE BGCOLOR='#ffffff' cellspacing=15 width=600><TR><TD width=100%>
This is the MCI control code that I wrote for my <A HREF="/UglyCD/">UglyCD 
player</A>.  It is fairly full featured, but if you need more, feel free to modify it to your needs.  I 
have neglected the error checking code, and every call to mciSendCommand should really be checked for 
its return value.  As usual, this code is usable at your own risk.  If you have any questions, you are 
always free to <A HREF='mailto:bosshogg@luggle.com'>ask</A>.
<BR>
<BR>
<I>-BossHogg</I>
<BR>
<BR>
<PRE>
#ifndef MCI_CONTROL
#define MCI_CONTROL 1

class MCIControl
{
     public:
          MCIControl();
          ~MCIControl();

          int     GetNumberOfTracks();
          void    Resume();
          void    Pause();
          void    Play();
          void    Stop();
          void    OpenDoor();
          void    CloseDoor();

          void    Goto(int track,int minute, int second);
		
          int     GetCurrentTrack();
          int     GetCurrentMinute();
          int     GetCurrentSecond();

     protected:
          void    Init();
          void    SetTimeFormat();
          void    GetPosition(BYTE* track,BYTE* min,BYTE* sec);

     private:
          MCIDEVICEID &nbsp itsMCIDevice;
};

#endif

</PRE>
<FONT face="Times New Roman" SIZE=2>

<BR>
<BR>
<BR>#include "windows.h"
<BR>#include "MCIControl.h"
<BR>
<BR>MCIControl::MCIControl() :
<BR><DD>itsMCIDevice(0)
<BR>{
<BR><DD>Init();
<BR><DD>SetTimeFormat();
<BR>}
<BR>
<BR>MCIControl::~MCIControl()
<BR>{
<BR><DD>MCI_GENERIC_PARMS Info;
<BR>
<BR><DD>Info.dwCallback=0;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_CLOSE, MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::Resume()
<BR>{
<BR><DD>MCI_PLAY_PARMS Info;
<BR><DD>BYTE track,minute,second;
<BR>
<BR><DD>GetPosition(&track,&minute,&second);
<BR><DD>Info.dwTo=0;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwFrom = MCI_MAKE_TMSF(track,minute,second,0);
<BR>
<BR><DD>mciSendCommand(itsMCIDevice, MCI_PLAY, MCI_FROM|MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::Pause()
<BR>{
<BR><DD>MCI_GENERIC_PARMS Info;
<BR>
<BR><DD>Info.dwCallback = 0;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_PAUSE, MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::Goto(int track,int minute, int second)
<BR>{
<BR><DD>MCI_PLAY_PARMS Info;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwTo=0;
<BR><DD>Info.dwFrom = MCI_MAKE_TMSF(track,minute,second,0);
<BR>
<BR><DD>mciSendCommand(itsMCIDevice, MCI_PLAY, MCI_FROM|MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>
<BR>void MCIControl::Play()
<BR>{
<BR><DD>MCI_PLAY_PARMS Info;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwTo=0;
<BR><DD>Info.dwFrom = MCI_MAKE_TMSF(0,0,0,0);
<BR>
<BR><DD>mciSendCommand(itsMCIDevice, MCI_PLAY, MCI_FROM|MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::Stop()
<BR>{
<BR><DD>MCI_GENERIC_PARMS Info;
<BR><DD>Info.dwCallback = 0;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_STOP, MCI_NOTIFY, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::OpenDoor()
<BR>{
<BR><DD>MCI_STATUS_PARMS Info;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwItem=0;
<BR><DD>Info.dwReturn=0;
<BR><DD>Info.dwTrack=0;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_SET, MCI_SET_DOOR_OPEN, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::CloseDoor()
<BR>{
<BR><DD>MCI_STATUS_PARMS Info;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwItem=0;
<BR><DD>Info.dwReturn=0;
<BR><DD>Info.dwTrack=0;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_SET, MCI_SET_DOOR_CLOSED, DWORD(&Info));
<BR>}
<BR>
<BR>int MCIControl::GetCurrentTrack()
<BR>{
<BR><DD>BYTE track;
<BR><DD>GetPosition(&track,NULL,NULL);
<BR><DD>return track;
<BR>}
<BR>
<BR>int MCIControl::GetCurrentMinute()
<BR>{
<BR><DD>BYTE minute;
<BR><DD>GetPosition(NULL,&minute,NULL);
<BR><DD>return minute;
<BR>}
<BR>
<BR>int MCIControl::GetCurrentSecond()
<BR>{
<BR><DD>BYTE second;
<BR><DD>GetPosition(NULL,NULL,&second);
<BR><DD>return second;
<BR>}
<BR>
<BR>int MCIControl::GetNumberOfTracks()
<BR>{
<BR><DD>MCI_STATUS_PARMS Info;
<BR><DD>Info.dwCallback = 0;
<BR><DD>Info.dwReturn = 0;
<BR><DD>Info.dwItem = MCI_STATUS_NUMBER_OF_TRACKS;
<BR><DD>Info.dwTrack = 0;
<BR><DD>mciSendCommand(itsMCIDevice,MCI_STATUS,MCI_STATUS_ITEM,DWORD(&Info));
<BR>
<BR><DD>return (int)Info.dwReturn;
<BR>}
<BR>
<BR>void MCIControl::GetPosition(BYTE* track,BYTE* min,BYTE* sec)
<BR>{
<BR><DD>MCI_STATUS_PARMS Info;
<BR><DD>DWORD MSF;
<BR>
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwReturn=0;
<BR><DD>Info.dwTrack=0;
<BR><DD>Info.dwItem = MCI_STATUS_POSITION;
<BR><DD>mciSendCommand(itsMCIDevice, MCI_STATUS, MCI_STATUS_ITEM, DWORD(&Info));
<BR>
<BR><DD>MSF = Info.dwReturn;
<BR>
<BR><DD>if (track)
<BR><DD><DD><DD>*track = MCI_MSF_MINUTE(MSF);
<BR><DD>if (min)
<BR><DD><DD><DD>*min = MCI_MSF_SECOND(MSF);
<BR><DD>if (sec)
<BR><DD><DD><DD>*sec = MCI_MSF_FRAME(MSF);
<BR>}
<BR>
<BR>void MCIControl::SetTimeFormat()
<BR>{
<BR><DD>MCI_SET_PARMS Info;
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.dwTimeFormat=MCI_FORMAT_TMSF;
<BR><DD>Info.dwAudio=0;
<BR>
<BR><DD>mciSendCommand(itsMCIDevice, MCI_SET, MCI_SET_TIME_FORMAT, DWORD(&Info));
<BR>}
<BR>
<BR>void MCIControl::Init()
<BR>{
<BR><DD>MCI_OPEN_PARMS Info;
<BR>
<BR><DD>Info.dwCallback=0;
<BR><DD>Info.lpstrAlias=0;
<BR><DD>Info.lpstrElementName=0;
<BR><DD>Info.wDeviceID=0;
<BR><DD>Info.lpstrDeviceType=MAKEINTRESOURCE(MCI_DEVTYPE_CD_AUDIO);
<BR><DD>mciSendCommand(0, MCI_OPEN, MCI_OPEN_TYPE|MCI_OPEN_TYPE_ID, DWORD(&Info));
<BR>
<BR><DD>itsMCIDevice = Info.wDeviceID;
<BR>}
</FONT>
</TD></TR></TABLE>
</TD></TR></TABLE>
		</TD>
	</TR>
</TABLE>
<BR>
<TABLE width=800>
	<TR>
		<TD width=120>
			&nbsp
		</TD>
		<TD>
			<MAP NAME="siteinfo">
				<AREA SHAPE="RECT" COORDS="525,6,545,23" HREF="http://www.redhat.com/">
				<AREA SHAPE="RECT" COORDS="546,6,575,23" HREF="http://www.apache.org/">
				<AREA SHAPE="RECT" COORDS="576,6,607,23" HREF="http://www.php.net/">
			</MAP>
			<IMG SRC="/images/footer.jpg" USEMAP="#siteinfo" border=0 width=619 height=26>
		</TD>
	</TR>
</TABLE>
</body>
</html>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<head>
	<title>Hazelware</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<LINK REL="SHORTCUT ICON" HREF="logo.ico">
</head>



<body vlink='#3173EB' link='#3173EB' leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>

<meta name="ICBM" content="45.30027, -122.9719" />
<meta name="keywords" content="Palm PalmOS WinCE PocketPC PDA Development Wireless" />
<meta name="description" content="Postings from a wireless PDA developer." />
<link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />
<style type="text/css">
<!--
A		{text-decoration:none}
a		{text-decoration:none}
A:hover 	{ color: #000000;  }
a:hover 	{ color: #000000;  }
-->
</style>


<table border=0 valign=top width=780>
	<TR>
		<TD width=100 valign=top>
		</TD>

		<!-- Title graphic -->
		<TD width=620 valign=top>
			<center><IMG SRC="/images/title.jpg" border=0 width=319 height=69></center>
			<br>&nbsp &nbsp &nbsp 


				<b><small>Logged in as <I><A HREF='/login.html'>Guest</A></I> &nbsp Sat, Feb. 14th, 11:21 PM.  &nbsp &nbsp &nbsp </small></b>
	
		</TD>
		<TD>
		</TD>
	</TR>
	<TR>

		<!-- Spacer for left border -->
		<TD>
		<!-- MyMap -->
		<a href="http://www.maploco.com/view.php?id=2376202"><img border=0 width=150 height=75 src="http://www.maploco.com/vmap/2376202.png" alt="Visitor Map"></a>
		</TD>

		<!-- Image map for browsing -->
		<TD width=620 valign=top>
			<TABLE width="100%" align=center valign=top>
				<TR>
					<TD width="100%">
						<MAP NAME="linkmap">
							<AREA SHAPE="RECT" COORDS= "10,27,90,52"  HREF="/">
							<AREA SHAPE="RECT" COORDS="100,27,207,52" HREF="/programs/">
							<AREA SHAPE="RECT" COORDS="220,27,328,52" HREF="/tutorials/">
							<AREA SHAPE="RECT" COORDS="338,27,428,52" HREF="/friends/">
							<AREA SHAPE="RECT" COORDS="442,27,509,52" HREF="/links/">
							<AREA SHAPE="RECT" COORDS="517,27,608,52" HREF="mailto:bosshogg@luggle.com">
						</MAP>
						<IMG src="/images/header.jpg" width=619 height=79 USEMAP="#linkmap" border=0>
					</TD>
				</TR>
			</TABLE>

		</TD>

		<TD>
		</TD>

		<TD>
		</TD>	
	</TR>
	
	<TR>
		<TD align=right valign=top>

		<TABLE border=0 cellspacing=0 cellpadding=0 width=150 align=center valign=top bordercolor='#000000'>
<TR><TD>
<TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Recent Entries:</B></TD></TR>
<TR><TD bgcolor='#ffffff' height=100%>
<small>
<TABLE valign=top align=left>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-102.html'><small>It&#39;s Not a Bug, It&#39;s a Feature!!!</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-101.html'><small>What I&#39;ve Been Up To</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-100.html'><small>Debugging Windows Mobile/WinCE Applications Without ActiveSync</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-99.html'><small>LinkedIn</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-98.html'><small>I&#39;m BACK!!!!!!</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-97.html'><small>Code Monkey</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-96.html'><small>Cool 3D Code Snippet From My Former Life</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-95.html'><small>YouTube: The Revival of the Internet Time Killer</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-94.html'><small>WhereMate Released</small></a></TD></TR>
<TR><TD valign=top>
<IMG SRC='/images/smallbullet.gif' width=7 height=13></TD><TD>
<a href='/archive-93.html'><small>Palmasaurus Released As Freeware</small></a></TD></TR>
</TABLE>
</TD></TR>
<TR><TD align=center valign=center>
<A HREF='/rss.xml'><IMG SRC='/images/rss.gif' border=0 width=60 height=14></A>
</TD></TR>
</TABLE>
</TD></TR>
<TR><TD><SMALL><SMALL><BR></SMALL></SMALL></TD></TR><TR><TD><TABLE border=1 cellspacing=0 cellpadding=5 width=100% align=center valign=top bordercolor='#000000'><TR><TD bgcolor='#B5D0FF'><B>Archive:</B></TD></TR><TR><TD bgcolor='#ffffff'><A HREF='/archive-2009.1.html'>January - 2009</A><br><A HREF='/archive-2008.5.html'>May - 2008</A><br><A HREF='/archive-2008.4.html'>April - 2008</A><br><A HREF='/archive-2008.3.html'>March - 2008</A><br><A HREF='/archive-2007.10.html'>October - 2007</A><br><A HREF='/archive-2007.8.html'>August - 2007</A><br><A HREF='/archive-2007.7.html'>July - 2007</A><br><A HREF='/archive-2007.6.html'>June - 2007</A><br><A HREF='/archive-2007.5.html'>May - 2007</A><br><A HREF='/archive-2007.4.html'>April - 2007</A><br><A HREF='/archive-2006.12.html'>December - 2006</A><br><A HREF='/archive-2006.11.html'>November - 2006</A><br><A HREF='/archive-2006.9.html'>September - 2006</A><br><A HREF='/archive-2006.8.html'>August - 2006</A><br><A HREF='/archive-2006.7.html'>July - 2006</A><br><A HREF='/archive-2006.3.html'>March - 2006</A><br><A HREF='/archive-2006.2.html'>February - 2006</A><br><A HREF='/archive-2006.1.html'>January - 2006</A><br><A HREF='/archive-2005.12.html'>December - 2005</A><br><A HREF='/archive-2005.11.html'>November - 2005</A><br><A HREF='/archive-2005.10.html'>October - 2005</A><br><A HREF='/archive-2005.9.html'>September - 2005</A><br><A HREF='/archive-2005.8.html'>August - 2005</A><br><A HREF='/archive-2005.7.html'>July - 2005</A><br><A HREF='/archive-2005.6.html'>June - 2005</A><br><A HREF='/archive-2005.5.html'>May - 2005</A><br><A HREF='/archive-2005.4.html'>April - 2005</A><br><A HREF='/archive-2005.2.html'>February - 2005</A><br><A HREF='/archive-2005.1.html'>January - 2005</A><br><A HREF='/archive-2004.12.html'>December - 2004</A><br><A HREF='/archive-2004.11.html'>November - 2004</A><br><A HREF='/archive-2004.10.html'>October - 2004</A><br><A HREF='/archive-2004.9.html'>September - 2004</A><br><A HREF='/archive-2004.8.html'>August - 2004</A><br><A HREF='/archive-2004.7.html'>July - 2004</A><br><A HREF='/archive-2004.6.html'>June - 2004</A><br><A HREF='/archive-2004.5.html'>May - 2004</A><br><A HREF='/archive-2004.4.html'>April - 2004</A><br><A HREF='/archive-2004.3.html'>March - 2004</A><br></TD></TR></TABLE></small>
</TD></TR></TABLE>

		</TD>
		<TD width=620 valign=top>


<style type="text/css">
<!--
A		{text-decoration:none}
a		{text-decoration:none}
A:hover 	{ color: #000000;  }
a:hover 	{ color: #000000;  }
-->
</style>

<TABLE border=0 cellspacing=0 cellpadding=5 width=580 align=center valign=top bordercolor='#ffffff'>
	<TR>
		<TD bgcolor='#ffffff'>
			<HR><CENTER><BIG><BIG><B><a href='/archive-66.html' border=0>Running as a Background Process on the PalmOS</a></B></BIG></BIG></CENTER>
		</TD>
	</TR>
	<TR>
		<TD bgcolor='#ffffff'>
			<FONT COLOR=#000000>
			 <B>Overview:</B>
<BR>At its core, the PalmOS is multithreaded.  However, for all intents and purposes it is generally considered a single threaded OS for application developers.  The OS itself is licensed/derived from the KADAK AMX kernel, which has support for threads, however there are no APIs to utilize them.  (My guess is because of licensing restrictions, but I don&#39;t know for sure.)
<BR>One of the questions that repeatedly comes up on the Palm Developer Forums is how to accomplish multi-threading.  However, when the question comes up, most developers really just want to know how to run a task in the background, and while there isn&#39;t an API to create threads, there are a few ways to implement tasks that run in the background.  In this article, I present a high level overview of four of the different techniques that I have used successfully in the past.
<BR>
<BR><B>Alarms:</B>
<BR>Perhaps the easiest way to run a task in the background is to register an event to occur.  In order to do that, you must use <A HREF="http://www.palmos.com/dev/support/docs/palmos/AlarmManager.html#995875">AlmSetAlarm</A> to create your alarm, and then handle either the sysAppLaunchCmdAlarmTriggered or the sysAppLaunchCmdDisplayAlarm launch codes in your application.  A couple caveats exist with these, however.  If your application isn&#39;t the current application when it receives the alarm events, you don&#39;t have access to global variables.  Furthermore, you can only use code that is in your first segment.  (There are various articles elsewhere on the web detailing these limitations, so I won&#39;t go into them here.)  The other limitation on this is that the latency on the alarms can be fairly high: it&#39;s probably not a good idea to use this method if you need to run more frequently than about every 5 seconds.  However, this method is very appropriate if your background task&#39;s function is to wake up every so often, look around and then go back to sleep.  For more "active" solutions, read on.
<BR>
<BR><B>Registering For sysNotifyEventDequeuedEvent:</B>
<BR>If you need lower latency in your functionality, and you are planning on running only on OS 5 and greater devices, you can register your application to receive sysNotifyEventDequeuedEvent notifications using the <A HREF="http://www.palmos.com/dev/support/docs/palmos/NotifyMgr.html#1024486">SysNotifyRegister</A> function.  As with any good solution, there are upsides and downsides.  The upside is that you get called back every time any event gets dequeued by any application anywhere in the system.  That in itself pretty much guarantees that you will get notified when something significant happens.  The other big upside of this method is that since your callback will get called for all events (including NULL events), you can use <A HREF="http://www.palmos.com/dev/support/docs/palmos/PalmOSReference/SystemEventManager.html#1071456">EvtSetNullEventTick</A> to control the maximum latency of your function without having to insert &#39;rogue&#39; events into another application&#39;s event queue.  (Although you can if you want to, but that&#39;s another article all together.)
<BR>The two downsides of this method are that 1. it is limited to OS5 and greater, and 2. depending on how much work you are doing in your callback, it could diminish the performance of the OS perceptibly.  That being said, I have used this method in the past without any noticible degradation in performance.
<BR>
<BR><B>Setting Traps:</B>
<BR>One method that is very similar to registering for sysNotifyEventDequeuedEvent notifications, is setting a system function trap using the SysSetTrapAddress function.  This is an older method of overriding the function for a system defined function.  However, this functionality has been removed in OS 5, and I won&#39;t go into it in detail here since it has been depricated.  (If you are looking for a good overview on this, try <A HREF="www.adhocconference.com/papers/2003/HackingPalmOS5.pdf ">here</A>.)  The basic method would apply as explained in the previous section on using sysNotifyEventDequeuedEvent notifications, however, the execution would be slightly different.
<BR>
<BR><B>The Sound Streaming Thread:</B>
<BR>Another method for running as a background process is to queue up a streaming sound and run in the callback for that streaming sound.  The most obvious limitation with this method is that it is only supported by devices that support the streaming sound API.  Those are mostly limited to OS 5 devices, but to be safe, make sure to check for the <A HREF = "http://www.palmos.com/dev/support/docs/palmos/PalmOSReference/CompatibilityApdx.html#997180" Sound Stream Feature Set</A>.  
<BR>There are various other references on the Internet how to do this, but the high level overview is that you create a variable length sound stream by calling
<A HREF = "http://www.palmos.com/dev/support/docs/palmos/PalmOSReference/SoundManager.html#1041201"> SndStreamCreateExtended
</A>.  You then must define a callback that conforms to the 
<A HREF = "http://www.palmos.com/dev/support/docs/palmos/PalmOSReference/SoundManager.html#1041201"> SndStreamVariableBufferCallback
</A> function definition.  It is in this callback that you can insert your code to work as a background process.  
<BR>In case you are wondering, you don&#39;t actually have to play a sound.  We&#39;re just exploiting the Streaming Sound Manager&#39;s API for callbacks to provide the functionality that you need.  
<BR>One thing to note about this method is that in your callback, you don&#39;t have access to any of the symbols (i.e. global variables) that you create in your application, so use this with care.
<BR>
<BR><B>Summary:</B>
<BR>The PalmOS is filled with many ways to get around all the different limitations that handheld devices create for developers.  The above four methods for running background tasks work very well for a very specific task.  There probably are other ways to solve the same problem.  These four methods are simply means to an end that I have used successfully in the past.  As in any instance, <A HREF="http://www.ymmv.com/">YMMV</A>.  If you have used any of these methods or if you have found a different way to accomplish the same task, <A HREF="mailto:bosshogg@luggle.com">I&#39;d love to hear about it</A>.
<BR>
<BR>-Jon
 
			</FONT>
		</TD>
	</TR>
	<TR>
		<TD bgcolor='#dddddd' align = center colspan=2>
		<i>Submitted by bosshogg on Friday the 29th of April 2005, at 02:29 pm</i>
		</TD>
	</TR>
</TABLE>
<BR>
</TD>
<TD width=20>
&nbsp
</TD>
<TD valign=top align=right>
		</TD>
	</TR>
</TABLE>
<BR>
<TABLE width=800>
	<TR>
		<TD width=120>
			&nbsp
		</TD>
		<TD>
			<MAP NAME="siteinfo">
				<AREA SHAPE="RECT" COORDS="525,6,545,23" HREF="http://www.redhat.com/">
				<AREA SHAPE="RECT" COORDS="546,6,575,23" HREF="http://www.apache.org/">
				<AREA SHAPE="RECT" COORDS="576,6,607,23" HREF="http://www.php.net/">
			</MAP>
			<IMG SRC="/images/footer.jpg" USEMAP="#siteinfo" border=0 width=619 height=26>
		</TD>
	</TR>
</TABLE>
</body>
</html>


